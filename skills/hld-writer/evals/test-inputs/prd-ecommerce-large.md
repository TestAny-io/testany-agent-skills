# PRD: 电商平台核心系统

> **用于 eval-2-1-to-n-split 测试**
>
> 此 PRD 范围较大，预期拆分为多个 HLD。

## 文档信息

| 属性 | 值 |
|------|-----|
| PRD 编号 | PRD-002 |
| 版本 | v1.0 |
| 状态 | 已批准 |

---

## 1. 背景与目标

### 1.1 业务背景

公司计划推出电商平台，需要完整的电商核心能力，包括用户管理、商品管理、订单处理、支付结算。

### 1.2 产品目标

构建完整的电商平台核心系统，支持：
- 用户注册、登录、个人中心
- 商品浏览、搜索、详情
- 购物车、下单、支付
- 订单管理、退款

---

## 2. 功能需求

### 模块一：用户系统

#### FR-101 用户注册登录

- 支持邮箱/手机号注册
- 支持密码登录
- 支持第三方登录（微信）

#### FR-102 用户资料

- 个人信息管理
- 收货地址管理
- 账户安全设置

#### FR-103 用户等级

- 会员等级体系
- 积分累计与兑换

### 模块二：商品系统

#### FR-201 商品管理

- 商品 CRUD
- 商品分类管理
- SKU 管理

#### FR-202 商品展示

- 商品列表
- 商品详情
- 商品搜索

#### FR-203 库存管理

- 库存查询
- 库存预占
- 库存扣减

### 模块三：订单系统

#### FR-301 购物车

- 添加商品
- 修改数量
- 删除商品
- 购物车结算

#### FR-302 订单创建

- 确认订单信息
- 选择收货地址
- 选择支付方式
- 提交订单

#### FR-303 订单管理

- 订单列表
- 订单详情
- 订单取消
- 订单状态流转

#### FR-304 退款

- 申请退款
- 退款审核
- 退款执行

### 模块四：支付系统

#### FR-401 支付

- 支付宝支付
- 微信支付
- 支付回调处理

#### FR-402 结算

- 商户结算
- 对账管理

---

## 3. 非功能需求

### NFR-001 性能

| 接口 | P99 响应时间 | 并发要求 |
|------|-------------|---------|
| 商品列表 | < 100ms | 5000 QPS |
| 商品详情 | < 50ms | 10000 QPS |
| 下单 | < 500ms | 1000 QPS |
| 支付 | < 1000ms | 500 QPS |

### NFR-002 安全

- 支付模块符合 PCI-DSS 要求
- 用户密码加密存储
- 敏感数据脱敏

### NFR-003 可用性

| 模块 | SLA |
|------|-----|
| 用户系统 | 99.9% |
| 商品系统 | 99.9% |
| 订单系统 | 99.95% |
| 支付系统 | 99.99% |

---

## 4. 拆分信号提示

> **此 PRD 包含以下拆分硬信号：**

1. **数据边界明确**
   - 用户数据 vs 商品数据 vs 订单数据 vs 支付数据
   - 各自有独立的数据模型和生命周期

2. **发布/回滚独立**
   - 用户系统相对稳定，发布频率低
   - 订单系统迭代频繁，需要独立灰度

3. **安全/合规域不同**
   - 支付系统有 PCI-DSS 合规要求
   - 需要独立的安全审计和部署环境

4. **性能/可用性目标不同**
   - 商品系统高并发、读多写少
   - 支付系统低并发、强一致性、最高 SLA

---

## 5. 相关能力识别

| 已有能力 | 能力范围 | 来源 |
|----------|---------|------|
| 短信服务 | 发送验证码 | `pkg/sms/` |
| 搜索服务 | Elasticsearch 封装 | `pkg/search/` |
| 消息队列 | Kafka 封装 | `pkg/mq/` |

---

## 6. 范围

### In-Scope

- 用户注册、登录、资料管理
- 商品管理、展示、搜索
- 购物车、订单、退款
- 支付宝/微信支付

### Out-of-Scope

- 营销活动（优惠券、满减）—— 另一个 PRD
- 物流管理 —— 另一个 PRD
- 商家入驻 —— 另一个 PRD
