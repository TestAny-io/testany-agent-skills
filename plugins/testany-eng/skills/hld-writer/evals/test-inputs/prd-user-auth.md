# PRD: 用户认证系统

> **用于 eval-1-basic-hld 测试**

## 文档信息

| 属性 | 值 |
|------|-----|
| PRD 编号 | PRD-001 |
| 版本 | v1.0 |
| 状态 | 已批准 |

---

## 1. 背景与目标

### 1.1 业务背景

当前系统没有用户认证功能，所有功能均为匿名访问。随着业务发展，需要：
- 识别用户身份
- 保护敏感操作
- 支持个性化功能

### 1.2 产品目标

为系统增加完整的用户认证能力，包括注册、登录、密码管理。

### 1.3 成功指标

| 指标 | 目标值 | 数据来源 |
|------|--------|----------|
| 注册转化率 | > 30% | 埋点统计 |
| 登录成功率 | > 95% | 埋点统计 |
| 密码重置完成率 | > 80% | 埋点统计 |

---

## 2. 功能需求

### FR-001 用户注册

**用户故事**：作为新用户，我希望能够注册账号，以便使用系统功能。

**验收标准**：
- 支持邮箱注册
- 支持手机号注册
- 密码强度校验（至少 8 位，含字母和数字）
- 发送验证邮件/短信

### FR-002 用户登录

**用户故事**：作为已注册用户，我希望能够登录系统。

**验收标准**：
- 支持邮箱/手机号 + 密码登录
- 登录失败 5 次后锁定 15 分钟
- 支持「记住我」功能（7 天免登录）

### FR-003 密码重置

**用户故事**：作为忘记密码的用户，我希望能够重置密码。

**验收标准**：
- 通过邮箱/手机号验证身份
- 重置链接 24 小时内有效
- 重置后旧会话失效

### FR-004 登出

**用户故事**：作为已登录用户，我希望能够安全登出。

**验收标准**：
- 清除当前会话
- 支持「登出所有设备」

---

## 3. 非功能需求

### NFR-001 性能

- 登录接口 P99 响应时间 < 200ms
- 支持 1000 QPS 并发登录

### NFR-002 安全

- 密码必须加密存储（不可逆）
- 防止暴力破解（限流 + 锁定）
- 敏感操作需要 HTTPS

### NFR-003 可用性

- 认证服务 SLA > 99.9%

---

## 4. 相关能力识别

| 已有能力 | 能力范围 | 与本需求匹配度 | 来源 |
|----------|---------|---------------|------|
| 短信发送服务 | 发送验证码短信 | 完全匹配 | `pkg/sms/` |
| 邮件发送服务 | 发送邮件 | 完全匹配 | `pkg/email/` |

---

## 5. 范围

### In-Scope

- 用户注册、登录、登出
- 密码重置
- 会话管理

### Out-of-Scope

- 第三方登录（微信、Google）—— 后续版本
- 双因素认证 —— 后续版本
- 用户资料管理 —— 另一个 PRD
